{% extends "_base.html" %}
{% block title %}Manage Admins{% endblock %}

{% block content %}
<h1>Manage Meraki Admins</h1>
<a href="{{ url_for('logout') }}">Logout / Change API Key</a>

<form method="post" action="{{ url_for('start_job') }}">

  <!-- Admin Info Section -->
  <h2>Admin Details</h2>
  <div style="margin-bottom:15px;">
    <label>Email:</label><br>
    <input type="email" name="email" required>
  </div>

  <div style="margin-bottom:20px;">
    <label>Name (required for add):</label><br>
    <input type="text" name="name">
  </div>

  <!-- Action Buttons -->
  <h2>Actions</h2>
  <div style="margin-bottom:20px;">
    <button type="submit" name="action" value="add_selected">
      Add to Selected
    </button>

    <button type="submit" name="action" value="delete_selected">
      Delete from Selected
    </button>

    <button type="submit" name="action" value="mass_add">
      Mass Add All
    </button>

    <button type="submit" name="action" value="mass_delete">
      Mass Delete All
    </button>
  </div>

  <!-- Organization List -->
  <h2>Select Organizations</h2>

  <div style="margin-bottom:10px;">
    <button type="button" onclick="selectAll()">Select All</button>
    <button type="button" onclick="deselectAll()">Deselect All</button>
  </div>

  <div style="max-height:300px; overflow:auto; border:1px solid #ccc; padding:10px;">
    {% for org_id, org_name in org_data.items() %}
      <div>
        <label>
          <input type="checkbox" name="orgs" value="{{ org_id }}">
          {{ org_name }} ({{ org_id }})
        </label>
      </div>
    {% endfor %}
  </div>

</form>

<script>
function selectAll() {
  document.querySelectorAll('input[name="orgs"]').forEach(cb => cb.checked = true);
}

function deselectAll() {
  document.querySelectorAll('input[name="orgs"]').forEach(cb => cb.checked = false);
}
</script>

{% endblock %}
